# 函式庫使用說明書

## 給使用者

歡迎使用中央大學自製輕量型齒輪相關參數函式庫。本函式庫可提供計算一條功率傳輸線上所有嚙合齒輪對的相關參數，其中齒輪對的數量不限，請根據需求使用。

本函式庫提供一個範例檔案，檔案格式為逗號分隔檔案（.csv），請事先安裝Microsoft Excel、Notepad++...等可編輯csv檔案的軟體。

本函式庫提供的範例檔案已內建好可輸入四個齒輪資料的格式與空白數值，若需要增加齒輪的數量，請複製預設「齒輪名字,3」區域的資料，並在預設「齒輪名字,3」區域與預設「齒輪名字,4」區域之間貼上，中間空白可不限。

**請注意！填寫好的檔案必須至少包含四個齒輪資料，每個齒輪資料的數值皆不得為空白或其他文字。除了可以複製預設「齒輪名字,3」區域的資料並於預設「齒輪名字,3」區域與預設「齒輪名字,4」區域之間貼上資料，其餘區域的資料格式皆不得隨意竄改、刪除以及調動位置！**

以下開始介紹如何填寫本函式庫提供的範例檔案：

* 齒輪名字：可以填寫該齒輪的名字，設計齒輪系統時有良好的命名習慣，對辨別齒輪有很大的幫助。
* 齒數：填寫該齒論上齒數。
* 法向模數：填寫該齒論對的法向模數，單位為mm。
* 壓力角：填寫該齒論對的壓力角，單位為degree。
* 螺旋角：填寫該齒論對的螺旋角，單位為degree。
* 齒面寬：填寫該齒論的齒面寬，單位為mm。
* 齒輪內孔直徑：填寫該齒論的內孔直徑，單位為mm。
* 轉位係數：填寫該齒論的轉位係數，單位為mm。
* 轉速：填寫該齒論的轉速，單位為rpm。
* 功率：填寫該齒論的功率，單位為W。
* 負荷係數：填寫該齒論對的負荷係數，填寫負荷係數請參照表1填寫。
* 尺寸係數：填寫該齒論對的尺寸係數。一般而言會將尺寸係數設為1，如大模數齒輪，會將尺寸係數設為「1.25」或「1.5」較為安全，請自行判斷。
* 是否導程修正：填寫該齒論對是否導程修正，填寫格式為「True」、「False」，大小寫皆可。
* 研磨製程：填寫該齒論對是否經過研磨製程，填寫格式為「True」、「False」，大小寫皆可。
* 齒輪使用場所選用：填寫該齒論對的使用場所，可以選用開放式齒輪、一般密閉式齒輪、精密密閉式齒輪以及超精密密閉式齒輪，填寫格式為「opentype」、「generalclosedtype」、「precisionclosedtype」以及「ultraprecisionclosedtype」。也可以輸入數字，其對應數字分別為「0」、「1」、「2」以及「3」。
* 齒輪嚙合次數：填寫該齒論對的嚙合次數。一般而言會設為「10000000」。
* 齒輪AGMA等級：填寫該齒論的AGMA等級。
* 潤滑油溫度：填寫該齒輪對使用的潤滑油溫度，也可視為該齒輪對的溫度。
* 小齒輪安裝修正因子：填寫該齒輪對的小齒輪安裝修正因子，若小齒輪與大齒輪面寬中心間的距離與齒輪軸兩端軸承的跨距比小於0.175，則設因子為1，若大於0.175則設因子為1.1，請自行判斷。
* 可靠度係數：填寫該齒輪對的可靠度係數，填寫可靠度係數請參照表2填寫。
* 蒲松比：填寫該齒輪的蒲松比。
* 楊氏係數：填寫該齒輪的楊氏係數。
* 勃氏硬度：填寫該齒輪的勃氏硬度。
* 齒面粗糙度：填寫該齒輪的齒面粗糙度。
* 是否與上個齒輪在同一軸上：填寫該齒輪是否與上個齒輪在同一軸上，填寫格式為「True」、「False」，大小寫皆可。

表1：負荷係數表

| 輸入機器 | 輸出機器 | 輸出機器 | 輸出機器 |
| -------- | -------- | -------- | -------- |
| 輸入機器 | 均力     | 中衝擊   | 重衝擊   |
| 均力     | 1.00     | 1.25     | 1.75     |
| 中衝擊   | 1.25     | 1.5      | 2        |
| 重衝擊   | 1.5      | 1.75     | 2.25     |

表2：可靠度係數

| 可靠度選擇 | 可靠度係數 |
| ---------- | ---------- |
| 90%        | 0.85       |
| 99%        | 1          |
| 99.9%      | 1.25       |
| 99.99%     | 1.5        |

**請注意！若填寫資料為該齒輪對的共同資料的話，本函式庫將優先以順序較前的齒輪資料為準！**

若資料填寫完畢，即可讓函式庫讀取檔案。**請注意！函式庫可讀取的檔案僅為逗號分隔檔案（.csv），若非csv檔請透過Microsoft Excel、Notepad++等軟體將檔案轉為csv檔。**

若資料填寫無誤，則會跳出通知說明資料讀取成功。若為失敗，則會跳出通知說明錯誤理由，請再修正檔案使其可被讀取。

當函式庫讀取完齒輪資料後，您可以選擇輸出格式，本函式庫提供逗號分隔檔案（.csv）與Markdown語法。如果有做報告的需求，可以利用輸出csv檔，再利用Microsoft Excel轉成Microsoft Excel工作表（.xlsx），以利於整理表格與打報告。若有線上協作的需求，可以利用輸出md語法，函式庫會輸出md語法中對應的表格形式，再將文字複製到協作專案裡即可。

**請注意！僅輸出逗號分隔檔案（.csv）時會在同一資料夾內產生新的csv檔，若有同名檔案則會被覆寫，切記輸出完檔案後記得更改舊的檔案名稱！**

## 給實作者

如沒有齒輪相關機械知識，請先閱讀上方說明書。

本函式庫的命名空間為NCUCalcGearParam，除非您同時使用其他來自中央大學的函式庫，建議您在程式碼的開頭寫上：
```csharp
using NCUCalcGearParam;
```

以下開始介紹如何使用本函式庫：

### 輸出範例檔案
如要輸出範例檔案，請呼叫以下方法，函式庫會自動在同一資料夾底下建立一個範例檔案。**請注意！若有同名檔案則會被覆寫，切記使用時將檔名做些更動！**
```csharp
NCUCalculate.CreateGearSystemExampleFile();
```

### 讀取齒輪系統檔案
如要讀取齒輪系統檔案，請呼叫以下方法，函式庫會自動讀取齒輪系統檔案，並建立齒輪資料。**請注意！該FilePath應為檔案的絕對路徑，另函式庫可讀取的檔案僅為逗號分隔檔案（.csv），若非csv檔請透過Microsoft Excel、Notepad++等軟體將檔案轉為csv檔。**
```csharp
NCUCalculate.ReadSystemFile(string FilePath);
```

若資料填寫無誤，則會跳出通知說明資料讀取成功。若為失敗，函式庫則會自動跳出通知並說明錯誤理由。

### 輸出計算結果
若齒輪資料建立完畢，則可以呼叫以下方法讀取計算結果。其中可以輸出逗號分隔檔案（.csv）與Markdown語法。如果有做報告的需求，可以利用輸出csv檔，再利用Microsoft Excel轉成Microsoft Excel工作表（.xlsx），以利於整理表格與打報告。若有線上協作的需求，可以利用輸出md語法，函式庫會輸出md語法中對應的表格形式，再將文字複製到協作專案裡即可。
```csharp
//輸出逗號分隔檔案
string NCUCalculate.GeneratecsvFile();
//輸出Markdown語法
string NCUCalculate.GeneratemdText();
```

**請注意！若齒輪資料尚未建立就呼叫方法，則會回傳null。且僅輸出逗號分隔檔案（.csv）時會在同一資料夾內產生新的csv檔，若有同名檔案則會被覆寫，切記輸出完檔案後記得更改舊的檔案名稱！**

### 建立單一齒輪對資料
若不需要範例檔案，在實作時已有另一套齒輪資料格式，本函式庫也有提供建立單一齒輪對資料的方法，函式庫同樣建立好齒輪資料後，再透過上述方法輸出計算結果。
```csharp
NCUCalculate.ReadGearPair(string Gear1Name, string Gear2Name, double z1, double z2, double F1, double F2, double di1, double di2, double x1, double x2, double n, double P, double Qv1, double Qv2, double v1, double v2, double E1, double E2, double HB1, double HB2, double mn, double alphan, double beta, double Ka, double Ks, CourseCorrection cmc, EngagementAxisAmendment ce, PlaceofUseGears cma, double N, double Tc, double cpm, double Kr, double Rq);
```

使用此方法時需要填入數個參數，要輸入的參數分別為：

* Gear1Name：齒輪1的名字
* Gear2Name：齒輪2的名字
* z1：齒輪1的齒數
* z2：齒輪2的齒數
* F1：齒輪1的齒面寬
* F2：齒輪2的齒面寬
* di1：齒輪1的內孔直徑
* di2：齒輪2的內孔直徑
* x1：齒輪1的轉位係數
* x2：齒輪2的轉位係數
* n：齒輪1的轉速
* P：齒輪1的功率
* Qv1：齒輪1的AGMA等級
* Qv2：齒輪2的AGMA等級
* v1：齒輪1的蒲松比
* v2：齒輪2的蒲松比
* E1：齒輪1的楊氏係數
* E2：齒輪2的楊氏係數
* HB1：齒輪1的勃氏硬度
* HB2：齒輪2的勃氏硬度
* mn：齒輪1的法向模數
* alphan：齒輪1的壓力角
* beta：齒輪1的螺旋角
* Ka：齒輪1的負荷係數
* Ks：齒輪1的尺寸係數
* cmc：齒輪1是否導程修正
* ce：齒輪1是否經過研磨製程
* cma：齒輪1使用場所選用
* N：齒輪1嚙合次數
* Tc：齒輪1使用的潤滑油溫度
* cpm：齒輪1的安裝修正因子
* Kr：齒輪1的可靠度係數
* Rq：齒輪1的齒面粗糙度

#### 負荷係數
請參照「給使用者」的表1。

#### 尺寸係數
一般而言會將尺寸係數設為1，如大模數齒輪，會將尺寸係數設為「1.25」或「1.5」較為安全，請自行判斷。

#### 是否導程修正
函式庫提供是否導程修正的列舉，請填入相對應的型別。
```csharp
enum CourseCorrection
    {
        Modification,
        NoModification
    }
```

#### 研磨製程
函式庫提供研磨製程的列舉，請填入相對應的型別。
```csharp
enum EngagementAxisAmendment
    {
        Grinding,
        NoGrinding
    }
```

#### 齒輪使用場所選用
函式庫提供齒輪使用場所選用的列舉，請填入相對應的型別。
```csharp
enum PlaceofUseGears
    {
        OpenType,
        GeneralClosedType,
        PrecisionClosedType,
        UltraPrecisionClosedType
    }
```
#### 小齒輪安裝修正因子
若小齒輪與大齒輪面寬中心間的距離與齒輪軸兩端軸承的跨距比小於0.175，則設因子為1，若大於0.175則設因子為1.1，請自行判斷。

#### 可靠度係數
請參照「給使用者」的表2。

### 顯示使用說明書
本函式庫以內建上述「給使用者」的說明書，請呼叫以下方法讓介面顯示該使用說明書。
```csharp
string NCUCalculate.ShowManual();
```